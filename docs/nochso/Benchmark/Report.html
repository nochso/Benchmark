<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta name="robots" content="index, follow, all" /><title>nochso\Benchmark\Report | noch.so Benchmark documentation</title><link rel="stylesheet" type="text/css" href="../../css/normalize.css"><link rel="stylesheet" type="text/css" href="../../css/min.css"><link rel="stylesheet" type="text/css" href="../../css/prism.css"><link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,700,400italic' rel='stylesheet' type='text/css'><script src="../../js/prism.js"></script><meta name="MobileOptimized" content="width"><meta name="HandheldFriendly" content="true"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"></head><body id="class" data-name="class:nochso_Benchmark_Report" data-root-path="../../"><nav><div class="container"><div class="title"><a href="../../index.html">noch.so Benchmark documentation</a></div><ul><li><a href="../../classes.html">Classes</a></li><li><a href="../../namespaces.html">Namespaces</a></li><li><a href="../../interfaces.html">Interfaces</a></li><li><a href="../../traits.html">Traits</a></li><li><a href="../../doc-index.html">Index</a></li><li><a href="../../search.html">Search</a></li></ul><ol class="breadcrumb"><li><a href="../../nochso.html">nochso</a></li><li><a href="../../nochso/Benchmark.html">Benchmark</a></li><li>Report</li></ol></div></nav><div class="container"><div class="row"><div id="control-panel"></div><div id="api-tree"></div></div><div class="row"><h1>Report</h1><p> class <strong>Report</strong></p><p>Report takes a list of Unit objects and creates a HTML report of the results.</p><h2>Constants</h2><table class="table"><tr><td><code class="language-php">BENCHMARK_VERSION = &#039;0.4.0&#039;;</code></td><td><p><em></em></p><p></p></td></tr></table><h2>Properties</h2><table class="table"><tr><td id="property_defaultConfig"><code class="language-php"> protected array</code></td><td><code class="language-php">$defaultConfig</code></td><td></td><td></td></tr><tr><td id="property_unitList"><code class="language-php"><a href="../../nochso/Benchmark/UnitList.html"><abbr title="nochso\Benchmark\UnitList">UnitList</abbr></a></code></td><td><code class="language-php">$unitList</code></td><td></td><td></td></tr></table><h2>Methods</h2><table class="table"><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php"></code></td><td><code class="language-php"><a href="#method___construct">__construct</a>(string $title, string $description = &#039;&#039;, array $config = array())</code></td><td> No description </td><td></td></tr><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php">string</code></td><td><code class="language-php"><a href="#method_getTitle">getTitle</a>()</code></td><td> Return the title of this report. </td><td></td></tr><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php">string</code></td><td><code class="language-php"><a href="#method_getDescription">getDescription</a>()</code></td><td> Return the description of this report. </td><td></td></tr><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php"></code></td><td><code class="language-php"><a href="#method_run">run</a>()</code></td><td> Runs all units and creates a HTML report. </td><td></td></tr><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php">string</code></td><td><code class="language-php"><a href="#method_getJavascript">getJavascript</a>()</code></td><td> Returns the combined and minified JS files from template_dir/asset/js. </td><td></td></tr><tr><td><code class="language-php"> public </code></td><td class="text-right"><code class="language-php">string</code></td><td><code class="language-php"><a href="#method_getCSS">getCSS</a>()</code></td><td> No description </td><td></td></tr></table><h2>Details</h2><div id="method-details"><div><div class="float-right"> at line <a href="#source.69">69</a></div><div><h3 id="method___construct"><code class="language-php">__construct()</code></h3><code class="language-php">public __construct(string $title, string $description = &#039;&#039;, array $config = array())</code></div></div><div class="details"><h4>Parameters</h4><table class="table"><tr><td><code class="language-php">string</code></td><td><code class="language-php">$title</code></td><td></td></tr><tr><td><code class="language-php">string</code></td><td><code class="language-php">$description</code></td><td></td></tr><tr><td><code class="language-php">array</code></td><td><code class="language-php">$config</code></td><td></td></tr></table></div><div><div class="float-right"> at line <a href="#source.92">92</a></div><div><h3 id="method_getTitle"><code class="language-php">getTitle()</code></h3><code class="language-php">public string&nbsp;getTitle()</code></div></div><div class="details"><div><p>Return the title of this report.</p></div><h4>Return Value</h4><table class="table"><tr><td><code class="language-php">string</code></td><td></td></tr></table></div><div><div class="float-right"> at line <a href="#source.102">102</a></div><div><h3 id="method_getDescription"><code class="language-php">getDescription()</code></h3><code class="language-php">public string&nbsp;getDescription()</code></div></div><div class="details"><div><p>Return the description of this report.</p></div><h4>Return Value</h4><table class="table"><tr><td><code class="language-php">string</code></td><td></td></tr></table></div><div><div class="float-right"> at line <a href="#source.110">110</a></div><div><h3 id="method_run"><code class="language-php">run()</code></h3><code class="language-php">public run()</code></div></div><div class="details"><div><p>Runs all units and creates a HTML report.</p></div></div><div><div class="float-right"> at line <a href="#source.154">154</a></div><div><h3 id="method_getJavascript"><code class="language-php">getJavascript()</code></h3><code class="language-php">public string&nbsp;getJavascript()</code></div></div><div class="details"><div><p>Returns the combined and minified JS files from template_dir/asset/js.</p></div><h4>Return Value</h4><table class="table"><tr><td><code class="language-php">string</code></td><td></td></tr></table></div><div><div class="float-right"> at line <a href="#source.170">170</a></div><div><h3 id="method_getCSS"><code class="language-php">getCSS()</code></h3><code class="language-php">public string&nbsp;getCSS()</code></div></div><div class="details"><h4>Return Value</h4><table class="table"><tr><td><code class="language-php">string</code></td><td></td></tr></table></div></div><h2>Source code</h2><pre class="language-php line-numbers" id="source"><code>&lt;?php

/*
 * This file is part of nochso/benchmark.
 *
 * @copyright Copyright (c) 2015 Marcel Voigt &lt;mv@noch.so&gt;
 * @license   https://github.com/nochso/benchmark/blob/master/LICENSE ISC
 * @link      https://github.com/nochso/benchmark
 */

namespace nochso\Benchmark;

use Cocur\Slugify\Bridge\Twig\SlugifyExtension;
use Cocur\Slugify\Slugify;
use nochso\Benchmark\Twig\GithubMarkdownExtension;
use nochso\Benchmark\Twig\ReportExtension;
use nochso\Benchmark\Util\Out;
use nochso\Benchmark\Util\Path;
use Symfony\Component\Finder\Finder;

/**
 * Report takes a list of Unit objects and creates a HTML report of the results.
 *
 * @author Marcel Voigt &lt;mv@noch.so&gt;
 * @copyright Copyright (c) 2015 Marcel Voigt &lt;mv@noch.so&gt;
 */
class Report
{
    const BENCHMARK_VERSION = &#039;0.4.0&#039;;

    /**
     * @var array
     */
    protected $defaultConfig = array(
        &#039;template_dir&#039; =&gt; __DIR__ . &#039;/../template&#039;,
        &#039;output_dir&#039; =&gt; &#039;build&#039;,
        &#039;twig&#039; =&gt; array(
            &#039;cache&#039; =&gt; &#039;cache/twig&#039;,
            &#039;auto_reload&#039; =&gt; true,
            &#039;strict_variables&#039; =&gt; true,
        ),
    );
    /**
     * @var \Twig_Environment
     */
    private $twig;
    /**
     * @var array
     */
    private $config = array();
    /**
     * @var UnitList
     */
    public $unitList;
    /**
     * @var string
     */
    private $title;
    /**
     * @var string
     */
    private $description;

    /**
     * @param string $title
     * @param string $description
     * @param array  $config
     */
    public function __construct($title, $description = &#039;&#039;, $config = array())
    {
        $this-&gt;unitList = new UnitList();
        $this-&gt;title = $title;
        $this-&gt;description = $description;
        $this-&gt;config = array_replace_recursive($this-&gt;defaultConfig, $config);
        $this-&gt;config[&#039;output_dir&#039;] = Path::join($this-&gt;config[&#039;output_dir&#039;]);
        $this-&gt;config[&#039;template_dir&#039;] = Path::join($this-&gt;config[&#039;template_dir&#039;]);
        $loader = new \Twig_Loader_Filesystem($this-&gt;config[&#039;template_dir&#039;]);
        $this-&gt;twig = new \Twig_Environment($loader, $this-&gt;config[&#039;twig&#039;]);
        $this-&gt;twig-&gt;addExtension(new SlugifyExtension(Slugify::create()));
        $this-&gt;twig-&gt;addExtension(new ReportExtension());
        $this-&gt;twig-&gt;addExtension(new \Jralph\Twig\Markdown\Extension(
            new GithubMarkdownExtension()
        ));
        $this-&gt;twig-&gt;addExtension(new \nochso\HtmlCompressTwig\Extension());
    }

    /**
     * Return the title of this report.
     *
     * @return string
     */
    public function getTitle()
    {
        return $this-&gt;title;
    }

    /**
     * Return the description of this report.
     *
     * @return string
     */
    public function getDescription()
    {
        return $this-&gt;description;
    }

    /**
     * Runs all units and creates a HTML report.
     */
    public function run()
    {
        Out::writeLine(&#039;Running nochso/benchmark &#039; . self::BENCHMARK_VERSION);
        Out::writeLine();
        $duration = -microtime(true);
        $progress = new Progress();
        $progress-&gt;prepareUnitList($this-&gt;unitList);
        foreach ($this-&gt;unitList as $unitName =&gt; $unit) {
            $unit-&gt;setProgress($progress);
            $unit-&gt;run();
        }
        $duration += microtime(true);
        $data = array(
            &#039;report&#039; =&gt; $this,
            &#039;title&#039; =&gt; $this-&gt;getTitle(),
            &#039;duration&#039; =&gt; $duration,
            &#039;min_duration&#039; =&gt; Timer::$defaultMinDuration,
            &#039;os&#039; =&gt; php_uname(&#039;s&#039;) . &#039; &#039; . php_uname(&#039;r&#039;) . php_uname(&#039;m&#039;),
            &#039;zend_extensions&#039; =&gt; get_loaded_extensions(true),
        );

        $this-&gt;render($data);
    }

    /**
     * @param $data
     */
    private function render($data)
    {
        $outputDir = $this-&gt;config[&#039;output_dir&#039;];
        if (!is_dir($outputDir)) {
            mkdir($outputDir, 0777, true);
        }
        $path = Path::join($outputDir, &#039;index.html&#039;);
        Out::writeLine(&#039;Saving HTML report to &#039; . $path);
        $html = $this-&gt;twig-&gt;render(&#039;report.twig&#039;, $data);
        file_put_contents($path, $html);
    }

    /**
     * Returns the combined and minified JS files from template_dir/asset/js.
     *
     * @return string
     */
    public function getJavascript()
    {
        $finder = Finder::create()
            -&gt;in(Path::join($this-&gt;config[&#039;template_dir&#039;], &#039;asset/js&#039;))
            -&gt;files()
            -&gt;name(&#039;*.js&#039;);
        $javascript = &#039;&#039;;
        foreach ($finder as $filepath) {
            $javascript .= file_get_contents($filepath) . &quot;\n&quot;;
        }
        return $javascript;
    }

    /**
     * @return string
     */
    public function getCSS()
    {
        $names = array(
            &#039;normalize&#039;,
            &#039;skeleton&#039;,
            &#039;prism&#039;,
            &#039;benchmark&#039;,
        );
        $cssDir = Path::join($this-&gt;config[&#039;template_dir&#039;], &#039;asset/css&#039;);
        $css = &#039;&#039;;
        foreach ($names as $name) {
            $path = Path::join($cssDir, $name . &#039;.css&#039;);
            $css .= file_get_contents($path) . &quot;\n&quot;;
        }
        return $css;
    }
}
</code></pre></div><div class="row"><div id="footer"> Generated by <a href="http://sami.sensiolabs.org/">Sami, the API Documentation Generator</a> using <a href="https://github.com/nochso/sami-theme">nochso/sami-theme</a>. </div></div></div></body></html>